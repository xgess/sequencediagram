// Example 10: Complete Feature Demo
// Exercises all Phase 1 features in a realistic scenario

title E-Commerce Checkout Flow

// Participants with various types and styling
actor "Customer" as User #yellow
participant "Web App" as App #lightblue #blue;2
participant "Cart\nService" as Cart #white #gray;1;dashed
participant "Payment\nGateway" as Pay #lightgreen
database "Order DB" as DB #lightyellow #orange;2

// Initial checkout request
User->App:**Checkout** clicked

// Cart validation with blank line for grouping
App->Cart:Get cart items
Cart-->App:Cart contents

alt#yellow #white cart not empty
  // Process the order
  App->Pay:Initialize payment

  loop #lightblue for each item
    Cart->DB:Reserve inventory
    DB-->Cart://Reserved//
  end

  Pay-->App:Payment form URL
  App-->User:Redirect to payment

  // Payment handling
  User->Pay:Submit payment

  alt payment successful
    Pay->App:Payment confirmed
    App->DB:**Create** order
    DB-->App:Order ID
    App->Cart:Clear cart
    App-->User:Order confirmation\nThank you!
  else payment failed
    Pay-->User://Payment declined//
  else payment timeout
    Pay-->User:Please try again
  end

else #pink #red;1;dashed cart empty
  App-->User:**Error**: Cart is empty
end

// Cleanup
User->App:Logout
