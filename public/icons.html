<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Icon Reference - Sequence Diagram</title>
  <link rel="stylesheet" href="lib/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="lib/mdi/css/materialdesignicons.min.css">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }

    h1 {
      margin: 0 0 10px 0;
      font-size: 24px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 20px;
    }

    .search-container {
      position: sticky;
      top: 0;
      background: #f5f5f5;
      padding: 10px 0 20px;
      z-index: 100;
    }

    .search-box {
      width: 100%;
      max-width: 400px;
      padding: 10px 14px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      outline: none;
    }

    .search-box:focus {
      border-color: #0066cc;
      box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.2);
    }

    .stats {
      margin-top: 10px;
      font-size: 13px;
      color: #666;
    }

    .tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 20px;
    }

    .tab {
      padding: 8px 16px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .tab:hover {
      background: #f0f0f0;
    }

    .tab.active {
      background: #0066cc;
      color: white;
      border-color: #0066cc;
    }

    .icon-section {
      display: none;
    }

    .icon-section.active {
      display: block;
    }

    .section-header {
      font-size: 18px;
      font-weight: 600;
      margin: 30px 0 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #ddd;
    }

    .section-header:first-child {
      margin-top: 0;
    }

    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 10px;
    }

    .icon-card {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .icon-card:hover {
      border-color: #0066cc;
      box-shadow: 0 2px 8px rgba(0, 102, 204, 0.15);
    }

    .icon-card.copied {
      background: #e8f5e9;
      border-color: #4caf50;
    }

    .icon-preview {
      font-size: 28px;
      width: 40px;
      text-align: center;
      flex-shrink: 0;
      color: #333;
    }

    .icon-info {
      overflow: hidden;
      flex: 1;
    }

    .icon-header {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 2px;
    }

    .icon-code {
      font-size: 14px;
      font-weight: 600;
      font-family: 'SF Mono', Monaco, Consolas, monospace;
      color: #0066cc;
    }

    .icon-name {
      font-size: 12px;
      color: #666;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .icon-usage {
      font-size: 11px;
      color: #888;
      font-family: 'SF Mono', Monaco, Consolas, monospace;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .no-results {
      text-align: center;
      padding: 40px;
      color: #666;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }

    .copy-hint {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 13px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }

    .copy-hint.show {
      opacity: 1;
    }

    .usage-hint {
      background: #fff8e8;
      border: 1px solid #f0e0c0;
      border-radius: 6px;
      padding: 12px 16px;
      margin-bottom: 20px;
      font-size: 13px;
    }

    .usage-hint code {
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'SF Mono', Monaco, Consolas, monospace;
    }
  </style>
</head>
<body>
  <h1>Icon Reference</h1>
  <p class="subtitle">Click an icon to copy its usage syntax to your clipboard</p>

  <div class="usage-hint">
    <strong>Usage:</strong> <code>fontawesome6solid f095 "Label" as Alias</code> or <code>materialdesignicons F0004 "Label" as Alias</code>
  </div>

  <div class="search-container">
    <input type="text" class="search-box" placeholder="Search by name or unicode..." id="search">
    <div class="stats" id="stats"></div>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="fontawesome">FontAwesome</div>
    <div class="tab" data-tab="mdi">Material Design</div>
  </div>

  <div id="fontawesome-section" class="icon-section active">
    <div class="loading">Loading FontAwesome icons...</div>
  </div>

  <div id="mdi-section" class="icon-section">
    <div class="loading">Loading Material Design icons...</div>
  </div>

  <div class="copy-hint" id="copy-hint">Copied to clipboard!</div>

  <script>
    // State - now stores objects with {name, unicode}
    let faIcons = { solid: [], regular: [], brands: [] };
    let mdiIcons = [];
    let currentTab = 'fontawesome';

    // DOM elements
    const searchInput = document.getElementById('search');
    const statsEl = document.getElementById('stats');
    const faSectionEl = document.getElementById('fontawesome-section');
    const mdiSectionEl = document.getElementById('mdi-section');
    const copyHintEl = document.getElementById('copy-hint');
    const tabs = document.querySelectorAll('.tab');

    // Tab switching
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentTab = tab.dataset.tab;

        document.querySelectorAll('.icon-section').forEach(s => s.classList.remove('active'));
        document.getElementById(`${currentTab}-section`).classList.add('active');

        updateStats();
      });
    });

    // Search
    searchInput.addEventListener('input', () => {
      renderIcons();
    });

    // Copy to clipboard
    function copyToClipboard(text, cardEl) {
      navigator.clipboard.writeText(text).then(() => {
        cardEl.classList.add('copied');
        copyHintEl.classList.add('show');
        setTimeout(() => {
          cardEl.classList.remove('copied');
          copyHintEl.classList.remove('show');
        }, 1500);
      });
    }

    // Create icon card
    function createIconCard(iconClass, name, unicode, usage) {
      const card = document.createElement('div');
      card.className = 'icon-card';
      card.innerHTML = `
        <div class="icon-preview"><i class="${iconClass}"></i></div>
        <div class="icon-info">
          <div class="icon-header">
            <span class="icon-code">${unicode}</span>
            <span class="icon-name">${name}</span>
          </div>
          <div class="icon-usage">${usage}</div>
        </div>
      `;
      card.addEventListener('click', () => copyToClipboard(usage, card));
      return card;
    }

    // Filter icons by search term (matches name or unicode)
    function filterIcons(icons, filter) {
      if (!filter) return icons;
      const filterLower = filter.toLowerCase();
      return icons.filter(icon =>
        icon.name.toLowerCase().includes(filterLower) ||
        icon.unicode.toLowerCase().includes(filterLower)
      );
    }

    // Render FontAwesome icons
    function renderFontAwesome(filter = '') {
      let html = '';

      const solidFiltered = filterIcons(faIcons.solid, filter);
      const regularFiltered = filterIcons(faIcons.regular, filter);
      const brandsFiltered = filterIcons(faIcons.brands, filter);

      if (solidFiltered.length > 0) {
        html += '<div class="section-header">Solid</div><div class="icon-grid" id="fa-solid-grid"></div>';
      }
      if (regularFiltered.length > 0) {
        html += '<div class="section-header">Regular</div><div class="icon-grid" id="fa-regular-grid"></div>';
      }
      if (brandsFiltered.length > 0) {
        html += '<div class="section-header">Brands</div><div class="icon-grid" id="fa-brands-grid"></div>';
      }

      const count = solidFiltered.length + regularFiltered.length + brandsFiltered.length;

      if (count === 0) {
        faSectionEl.innerHTML = '<div class="no-results">No icons found matching your search</div>';
        return 0;
      }

      faSectionEl.innerHTML = html;

      const solidGrid = document.getElementById('fa-solid-grid');
      const regularGrid = document.getElementById('fa-regular-grid');
      const brandsGrid = document.getElementById('fa-brands-grid');

      solidFiltered.forEach(icon => {
        const usage = `fontawesome6solid ${icon.unicode} Name`;
        solidGrid?.appendChild(createIconCard(`fa-solid fa-${icon.name}`, icon.name, icon.unicode, usage));
      });

      regularFiltered.forEach(icon => {
        const usage = `fontawesome6regular ${icon.unicode} Name`;
        regularGrid?.appendChild(createIconCard(`fa-regular fa-${icon.name}`, icon.name, icon.unicode, usage));
      });

      brandsFiltered.forEach(icon => {
        const usage = `fontawesome6brands ${icon.unicode} Name`;
        brandsGrid?.appendChild(createIconCard(`fa-brands fa-${icon.name}`, icon.name, icon.unicode, usage));
      });

      return count;
    }

    // Render MDI icons
    function renderMDI(filter = '') {
      const filtered = filterIcons(mdiIcons, filter);

      if (filtered.length === 0) {
        mdiSectionEl.innerHTML = '<div class="no-results">No icons found matching your search</div>';
        return 0;
      }

      mdiSectionEl.innerHTML = '<div class="icon-grid" id="mdi-grid"></div>';
      const grid = document.getElementById('mdi-grid');

      filtered.forEach(icon => {
        const usage = `materialdesignicons ${icon.unicode} Name`;
        grid.appendChild(createIconCard(`mdi mdi-${icon.name}`, icon.name, icon.unicode, usage));
      });

      return filtered.length;
    }

    // Render all icons
    function renderIcons() {
      const filter = searchInput.value.trim();

      if (currentTab === 'fontawesome') {
        renderFontAwesome(filter);
      } else {
        renderMDI(filter);
      }

      updateStats();
    }

    // Update stats
    function updateStats() {
      const filter = searchInput.value.trim();

      if (currentTab === 'fontawesome') {
        const total = faIcons.solid.length + faIcons.regular.length + faIcons.brands.length;
        if (filter) {
          const filtered =
            filterIcons(faIcons.solid, filter).length +
            filterIcons(faIcons.regular, filter).length +
            filterIcons(faIcons.brands, filter).length;
          statsEl.textContent = `Showing ${filtered} of ${total} FontAwesome icons`;
        } else {
          statsEl.textContent = `${total} FontAwesome icons (${faIcons.solid.length} solid, ${faIcons.regular.length} regular, ${faIcons.brands.length} brands)`;
        }
      } else {
        const total = mdiIcons.length;
        if (filter) {
          const filtered = filterIcons(mdiIcons, filter).length;
          statsEl.textContent = `Showing ${filtered} of ${total} Material Design icons`;
        } else {
          statsEl.textContent = `${total} Material Design icons`;
        }
      }
    }

    // Load FontAwesome icons from metadata
    async function loadFontAwesomeIcons() {
      try {
        const response = await fetch('lib/fontawesome/metadata/icons.json');
        const data = await response.json();

        for (const [name, info] of Object.entries(data)) {
          const unicode = info.unicode;
          const styles = info.styles || [];
          if (styles.includes('solid')) faIcons.solid.push({ name, unicode });
          if (styles.includes('regular')) faIcons.regular.push({ name, unicode });
          if (styles.includes('brands')) faIcons.brands.push({ name, unicode });
        }

        // Sort alphabetically by name
        faIcons.solid.sort((a, b) => a.name.localeCompare(b.name));
        faIcons.regular.sort((a, b) => a.name.localeCompare(b.name));
        faIcons.brands.sort((a, b) => a.name.localeCompare(b.name));

        renderFontAwesome();
        updateStats();
      } catch (err) {
        console.error('Failed to load FontAwesome icons:', err);
        faSectionEl.innerHTML = '<div class="no-results">Failed to load FontAwesome icons</div>';
      }
    }

    // Load MDI icons from CSS
    async function loadMDIIcons() {
      try {
        const response = await fetch('lib/mdi/css/materialdesignicons.css');
        const css = await response.text();

        // Extract icon names and unicode from CSS rules
        // Format spans multiple lines:
        // .mdi-account::before {
        //   content: "\F0004";
        const regex = /\.mdi-([a-z0-9-]+)::before\s*\{[^}]*content:\s*"\\([A-F0-9]+)"/g;
        let match;
        const iconMap = new Map();

        while ((match = regex.exec(css)) !== null) {
          const name = match[1];
          const unicode = match[2];
          // Skip duplicates (some icons have multiple entries)
          if (!iconMap.has(name)) {
            iconMap.set(name, unicode);
          }
        }

        // Convert to array and sort
        mdiIcons = Array.from(iconMap.entries())
          .map(([name, unicode]) => ({ name, unicode }))
          .sort((a, b) => a.name.localeCompare(b.name));

        renderMDI();
        updateStats();
      } catch (err) {
        console.error('Failed to load MDI icons:', err);
        mdiSectionEl.innerHTML = '<div class="no-results">Failed to load Material Design icons</div>';
      }
    }

    // Initialize
    loadFontAwesomeIcons();
    loadMDIIcons();
  </script>
</body>
</html>
